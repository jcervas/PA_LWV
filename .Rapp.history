plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,0))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
                legend("topright", legend="Donate", text.col="#000000", bty="n", cex=1, text.font=2)#
#
}#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,0))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
                legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
barplot ( ) #
text(x= 2.9, y = 0.43, srt=90, labels = "H", cex = 1.5, col="blue")  #srt #
rotates the "H" character, so that it resembles an error bar #
text(x=3.5, y=0.432,  labels = "95% C.I.", cex=1.1)
barplot ( )
text(x= 2.9, y = 0.43, srt=90, labels = "H", cex = 1.5, col="blue")
text(x=3.5, y=0.432,  labels = "95% C.I.", cex=1.1)
barplot ( ) #
text(x= 2.9, y = 0.43, srt=90, labels = "H", cex = 1.5, col="blue")  #
text(x=3.5, y=0.432,  labels = "95% C.I.", cex=1.1)
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
                legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, (data2[3,]-data2[1,])/2, 4.5, (data2[3,]-data2[1,])/2, length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.o
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, (data2[3,1]-data2[1,1])/2, 4.5, (data2[3,1]-data2[1,1])/2, length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, (data2[2,1]-data2[1,1])/2, 4.5, (data2[2,1]-data2[1,1])/2, length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, (data2[3,1]-data2[1,1]), 4.5, (data2[3,1]-data2[1,1]), length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,1]-data2[1,1])+data2[1,1], 4.5, ((data2[3,1]-data2[1,1])+data2[1,1], length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,1]-data2[1,1])+data2[1,1]), 4.5, ((data2[3,1]-data2[1,1])+data2[1,1]), length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,1]-data2[1,1]/2)+data2[1,1]), 4.5, ((data2[3,1]-data2[1,1]/2)+data2[1,1]), length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,1]-data2[1,1])/2+data2[1,1]), 4.5, ((data2[3,1]-data2[1,1])/2+data2[1,1]), length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,1]-data2[1,1])/2)+data2[1,1], 4.5, ((data2[3,1]-data2[1,1])/2)+data2[1,1], length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
CI(3,.04)
4-3/2
(4-3)/2
(4-3)/2 + 3
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,1]-data2[1,1])/2)+data2[1,1], 4.5, ((data2[3,1]-data2[1,1])/2)+data2[1,1], length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,4]-data2[1,4])/2)+data2[1,4], 4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], length = 0.2, col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,4]-data2[1,4])/2)+data2[1,4], 4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], length = 0.2, col='black')#
text(4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], labels="95% Confidence Interval", col='black')#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,4]-data2[1,4])/2)+data2[1,4], 4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], length = 0.2, col='black')#
text(4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], labels="95% Confidence Interval", col='black', pos=2)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,4]-data2[1,4])/2)+data2[1,4], 4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], length = 0.2, col='black')#
text(4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], labels="95% Confidence Interval", col='black', pos=3)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,4]-data2[1,4])/2)+data2[1,4], 4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], length = 0.2, col='black')#
text(4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,4]-data2[1,4])/2)+data2[1,4], 4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], length = 0.2, col='black')#
text(4, ((data2[3,4]-data2[1,4])/2)+data2[1,1], labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,4]-data2[1,4])/2)+data2[1,4], 4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], length = 0.2, col='black')#
text(4.25, ((data2[3,4]-data2[1,4])/2)+data2[1,1], labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, ((data2[3,4]-data2[1,4])/2)+data2[1,4], 4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], length = 0.2, col='black')#
text(4.5, ((data2[3,4]-data2[1,4])/2)+data2[1,1], labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, legend.placement, 4.5, legend.placement, length = 0.2, col='black')#
text(4, legend.placement, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
arrows(4.25, legend.placement, 4.5, legend.placement*1.2, length = 0.2, col='black')#
text(4, legend.placement, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
            abline(4, legend.placement, 4.5, legend.placement*1.5)#
arrows(4.5, legend.placement, 4.5, legend.placement*1.5, length = 0.2, col='black')#
text(4, legend.placement, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
            abline(a=c(4, legend.placement), b=(4.5, legend.placement*1.5))#
arrows(4.5, legend.placement, 4.5, legend.placement*1.5, length = 0.2, col='black')#
text(4, legend.placement, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot(c(-2,3), c(-1,5), type = "n", xlab = "x", ylab = "y", asp = 1)#
## the x- and y-axis, and an integer grid#
abline(h = 0, v = 0, col = "gray60")#
text(1,0, "abline( h = 0 )", col = "gray60", adj = c(0, -.1))#
abline(h = -1:5, v = -2:3, col = "lightgray", lty = 3)
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
            lines(c(4, legend.placement), c(4.5, legend.placement*1.5))#
arrows(4.5, legend.placement, 4.5, legend.placement*1.5, length = 0.2, col='black')#
text(4, legend.placement, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
            lines(c(4, legend.placement), c(4.5, legend.placement))#
arrows(4.5, legend.placement, 4.5, legend.placement*1.5, length = 0.2, col='black')#
text(4, legend.placement, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
xy.coords(1:3, 1:2, recycle = TRUE)
plot(xy.coords(1:3, 1:2, recycle = TRUE))
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)
legend.placement <- .06
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)
lines(xy.coords(c(4, 4.5), c(legend.placement, legend.placement)))
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)
lines(xy.coords(c(4.25, 4.5), c(legend.placement, legend.placement)))
arrows(4.25, legend.placement, 4.5, legend.placement*1.5, length = 0.2, col='black')
arrows(4.5, legend.placement, 4.25, legend.placement*1.5, length = 0.2, col='black')
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
            lines(xy.coords(c(4.25, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
            lines(xy.coords(c(4.25, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
    lines(xy.coords(c(4.16, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.5)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.81, 4.25), c(data1[1,4], data1[1,4])))#
arrows(3.81, data1[1,4], 4.25, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*3, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.81, 4), c(data1[1,4], data1[1,4])))#
arrows(3.81, data1[1,4], 4.25, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*3, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.75, 3.81), c(data1[1,4], data1[1,4])))#
arrows(3.75, data1[1,4], 4, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*3, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.75, 3.81), c(data1[1,4], data1[1,4])))#
arrows(3.75, data1[1,4], 3.81, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*2, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off(
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.75, 3.81), c(data1[1,4], data1[1,4])))#
arrows(3.75, data1[1,4], 3.91, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*2, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.75, 3.91), c(data1[1,4], data1[1,4])))#
arrows(3.75, data1[1,4], 3.81, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*2, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.75, 3.97), c(data1[1,4], data1[1,4])))#
arrows(3.75, data1[1,4], 3.81, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*2, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.75, 3.95), c(data1[1,4], data1[1,4])))#
arrows(3.75, data1[1,4], 3.81, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*2, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(contactF, contactM, contactF_se, contactM_se, "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
c(contact_main, commwk_main, donate_main, protest_main, social_main, vote_main, votelocal_main)#
c(contact_ylab, commwk_ylab, donate_ylab, protest_ylab, social_ylab, vote_ylab, votelocal_ylab)#
c(contactF, commwkF, donateF, protestF, socialF, voteF, votelocalF)#
c(contactM, commwkM, donateM, protestM, socialM, voteM, votelocalM)#
c(contactF_se, commwkF_se, donateF_se, protestF_se, socialF_se, voteF_se, votelocalF_se)#
c(contactM_se, commwkM_se, donateM_se, protestM_se, socialM_se, voteM_se, votelocalM_se)#
contact_main <- "Contact on Contacting on an Issue,"#
contact_ylab <- "OLS Coefficient On Norm To Contact On Issues"#
#
contactF <- #
c(0.0860655,#
0.0697297,#
0.0478951,#
0.0454305)#
#
contactF_se <- #
c(0.019,#
0.013,#
0.01,#
0.017)#
#
contactM <- #
c(0.1488321,#
0.0566743,#
0.0497024,#
0.0659856)#
#
contactM_se <- #
c(0.029,#
0.016,#
0.014,#
0.022)#
commwk_main <- "Work on Community Problem on Working to Solve a Community Problem,"#
commwk_ylab <- "OLS Coefficient On Norm To Work With Others To Solve Community Problem"#
#
commwkF <- #
c(0.0755397,#
0.0645092,#
0.0431188,#
0.0594256)#
#
commwkF_se <- #
c(0.017,#
0.013,#
0.009,#
0.018)#
#
commwkM <- #
c(0.1290913,#
0.078696,#
0.0828597,#
0.0851571)#
#
commwkM_se <- #
c(0.025,#
0.016,#
0.016,#
0.019)#
donate_main <- "Donate on Donating to a Campaign,"#
donate_ylab <- "OLS Coefficient On Norm To Donate To A Campaign Or Cause"#
#
donateF <- #
c(0.0937791,#
0.0607834,#
0.0614953,#
0.0701727)#
#
donateF_se <- #
c(0.019,#
0.012,#
0.009,#
0.016)#
#
donateM <- #
c(0.1583963,#
0.0870401,#
0.0892198,#
0.0830664)#
#
donateM_se <- #
c(0.024,#
0.018,#
0.017,#
0.018)#
protest_main <- "Protest on Attending a Protest,"#
protest_ylab <- "OLS Coefficient On Norm To Attend Protest"#
#
protestF <- #
c(0.0587314,#
0.073317,#
0.0531946,#
0.0648408)#
#
protestF_se <- #
c(0.013,#
0.013,#
0.008,#
0.013)#
#
protestM <- #
c(0.1069584,#
0.0574463,#
0.0333203,#
0.0430373)#
#
protestM_se <- #
c(0.021,#
0.016,#
0.015,#
0.013)#
social_main <- "Use Social Media for Politics on Posting Politics on Social Media,"#
social_ylab <- "OLS Coefficient On Norm To Use Social Media For Politics"#
#
socialF <- #
c(0.1587346,#
0.1203141,#
0.1219445,#
0.1289472)#
#
socialF_se <- #
c(0.022,#
0.014,#
0.012,#
0.02)#
#
socialM <- #
c(0.1462155,#
0.0897798,#
0.1250902,#
0.1150495)#
#
socialM_se <- #
c(0.029,#
0.02,#
0.017,#
0.02)#
vote_main <- "Vote on Voting in 2016,"#
vote_ylab <- "OLS Coefficient On Norm To Vote"#
#
voteF <- #
c(0.1444461,#
0.1028096,#
0.1239695,#
0.1057274)#
#
voteF_se <- #
c(0.024,#
0.014,#
0.013,#
0.019)#
#
voteM <- #
c(0.1092774,#
0.0920095,#
0.11765,#
0.1502012)#
#
voteM_se <- #
c(0.026,#
0.018,#
0.017,#
0.022)#
votelocal_main <- "Vote on Voting in State and Local Elections,"#
votelocal_ylab <- "OLS Coefficient On Norm To Vote"#
#
votelocalF <- #
c(0.3150406,#
0.131653,#
0.1585753,#
0.2737248)#
#
votelocalF_se <- #
c(0.067,#
0.043,#
0.034,#
0.047)#
#
votelocalM <- #
c(0.2192945,#
0.1622558,#
0.2397637,#
0.2111982)#
#
votelocalM_se <- #
c(0.081,#
0.057,#
0.041,#
0.073)#
#
ci.tmp <- CI(contact, contact_se)#
ci2.tmp <- CI(contact2, contact2_se)#
plot.coef.bars(contact, contact2, ci.tmp[1,], ci.tmp[2,], ci2.tmp[1,], ci2.tmp[2,], "F", "M", main=main, xlab=xlab, ylab=ylab)#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==1#
 cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- formula(. ~ age + age65 + faminc + educ + homeowner + unemployed + pctnonUS + ptystn + orgactive + interest + linkfate + recruitact_ldr)#
summary(m <- lm(update(base.form, contactissue ~ female + normcontactNM + femnormContact +.), weight= weight, data=cmps1))#
#
coeftest(m, vcov = vcovHC(m, type="HC1"))#
library(lmtest)#
#
library(sandwich)
c(contact_main, commwk_main, donate_main, protest_main, social_main, vote_main, votelocal_main)#
c(contact_ylab, commwk_ylab, donate_ylab, protest_ylab, social_ylab, vote_ylab, votelocal_ylab)#
c(contactF, commwkF, donateF, protestF, socialF, voteF, votelocalF)#
c(contactM, commwkM, donateM, protestM, socialM, voteM, votelocalM)#
c(contactF_se, commwkF_se, donateF_se, protestF_se, socialF_se, voteF_se, votelocalF_se)#
c(contactM_se, commwkM_se, donateM_se, protestM_se, socialM_se, voteM_se, votelocalM_se)#
contact_main <- "Contact on Contacting on an Issue,"#
contact_ylab <- "OLS Coefficient On Norm To Contact On Issues"#
#
contactF <- #
c(0.0860655,#
0.0697297,#
0.0478951,#
0.0454305)#
#
contactF_se <- #
c(0.019,#
0.013,#
0.01,#
0.017)#
#
contactM <- #
c(0.1488321,#
0.0566743,#
0.0497024,#
0.0659856)#
#
contactM_se <- #
c(0.029,#
0.016,#
0.014,#
0.022)#
commwk_main <- "Work on Community Problem on Working to Solve a Community Problem,"#
commwk_ylab <- "OLS Coefficient On Norm To Work With Others To Solve Community Problem"#
#
commwkF <- #
c(0.0755397,#
0.0645092,#
0.0431188,#
0.0594256)#
#
commwkF_se <- #
c(0.017,#
0.013,#
0.009,#
0.018)#
#
commwkM <- #
c(0.1290913,#
0.078696,#
0.0828597,#
0.0851571)#
#
commwkM_se <- #
c(0.025,#
0.016,#
0.016,#
0.019)#
donate_main <- "Donate on Donating to a Campaign,"#
donate_ylab <- "OLS Coefficient On Norm To Donate To A Campaign Or Cause"#
#
donateF <- #
c(0.0937791,#
0.0607834,#
0.0614953,#
0.0701727)#
#
donateF_se <- #
c(0.019,#
0.012,#
0.009,#
0.016)#
#
donateM <- #
c(0.1583963,#
0.0870401,#
0.0892198,#
0.0830664)#
#
donateM_se <- #
c(0.024,#
0.018,#
0.017,#
0.018)#
protest_main <- "Protest on Attending a Protest,"#
protest_ylab <- "OLS Coefficient On Norm To Attend Protest"#
#
protestF <- #
c(0.0587314,#
0.073317,#
0.0531946,#
0.0648408)#
#
protestF_se <- #
c(0.013,#
0.013,#
0.008,#
0.013)#
#
protestM <- #
c(0.1069584,#
0.0574463,#
0.0333203,#
0.0430373)#
#
protestM_se <- #
c(0.021,#
0.016,#
0.015,#
0.013)#
social_main <- "Use Social Media for Politics on Posting Politics on Social Media,"#
social_ylab <- "OLS Coefficient On Norm To Use Social Media For Politics"#
#
socialF <- #
c(0.1587346,#
0.1203141,#
0.1219445,#
0.1289472)#
#
socialF_se <- #
c(0.022,#
0.014,#
0.012,#
0.02)#
#
socialM <- #
c(0.1462155,#
0.0897798,#
0.1250902,#
0.1150495)#
#
socialM_se <- #
c(0.029,#
0.02,#
0.017,#
0.02)#
vote_main <- "Vote on Voting in 2016,"#
vote_ylab <- "OLS Coefficient On Norm To Vote"#
#
voteF <- #
c(0.1444461,#
0.1028096,#
0.1239695,#
0.1057274)#
#
voteF_se <- #
c(0.024,#
0.014,#
0.013,#
0.019)#
#
voteM <- #
c(0.1092774,#
0.0920095,#
0.11765,#
0.1502012)#
#
voteM_se <- #
c(0.026,#
0.018,#
0.017,#
0.022)#
votelocal_main <- "Vote on Voting in State and Local Elections,"#
votelocal_ylab <- "OLS Coefficient On Norm To Vote"#
#
votelocalF <- #
c(0.3150406,#
0.131653,#
0.1585753,#
0.2737248)#
#
votelocalF_se <- #
c(0.067,#
0.043,#
0.034,#
0.047)#
#
votelocalM <- #
c(0.2192945,#
0.1622558,#
0.2397637,#
0.2111982)#
#
votelocalM_se <- #
c(0.081,#
0.057,#
0.041,#
0.073)#
#
ci.tmp <- CI(contact, contact_se)#
ci2.tmp <- CI(contact2, contact2_se)#
plot.coef.bars(contact, contact2, ci.tmp[1,], ci.tmp[2,], ci2.tmp[1,], ci2.tmp[2,], "F", "M", main=main, xlab=xlab, ylab=ylab)#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==1#
 cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- formula(. ~ age + age65 + faminc + educ + homeowner + unemployed + pctnonUS + ptystn + orgactive + interest + linkfate + recruitact_ldr)#
summary(m <- lm(update(base.form, contactissue ~ female + normcontactNM + femnormContact +.), weight= weight, data=cmps1))
c(contact_main, commwk_main, donate_main, protest_main, social_main, vote_main, votelocal_main)#
c(contact_ylab, commwk_ylab, donate_ylab, protest_ylab, social_ylab, vote_ylab, votelocal_ylab)#
c(contactF, commwkF, donateF, protestF, socialF, voteF, votelocalF)#
c(contactM, commwkM, donateM, protestM, socialM, voteM, votelocalM)#
c(contactF_se, commwkF_se, donateF_se, protestF_se, socialF_se, voteF_se, votelocalF_se)#
c(contactM_se, commwkM_se, donateM_se, protestM_se, socialM_se, voteM_se, votelocalM_se)#
contact_main <- "Contact on Contacting on an Issue,"#
contact_ylab <- "OLS Coefficient On Norm To Contact On Issues"#
#
contactF <- #
c(0.0860655,#
0.0697297,#
0.0478951,#
0.0454305)#
#
contactF_se <- #
c(0.019,#
0.013,#
0.01,#
0.017)#
#
contactM <- #
c(0.1488321,#
0.0566743,#
0.0497024,#
0.0659856)#
#
contactM_se <- #
c(0.029,#
0.016,#
0.014,#
0.022)#
commwk_main <- "Work on Community Problem on Working to Solve a Community Problem,"#
commwk_ylab <- "OLS Coefficient On Norm To Work With Others To Solve Community Problem"#
#
commwkF <- #
c(0.0755397,#
0.0645092,#
0.0431188,#
0.0594256)#
#
commwkF_se <- #
c(0.017,#
0.013,#
0.009,#
0.018)#
#
commwkM <- #
c(0.1290913,#
0.078696,#
0.0828597,#
0.0851571)#
#
commwkM_se <- #
c(0.025,#
0.016,#
0.016,#
0.019)#
donate_main <- "Donate on Donating to a Campaign,"#
donate_ylab <- "OLS Coefficient On Norm To Donate To A Campaign Or Cause"#
#
donateF <- #
c(0.0937791,#
0.0607834,#
0.0614953,#
0.0701727)#
#
donateF_se <- #
c(0.019,#
0.012,#
0.009,#
0.016)#
#
donateM <- #
c(0.1583963,#
0.0870401,#
0.0892198,#
0.0830664)#
#
donateM_se <- #
c(0.024,#
0.018,#
0.017,#
0.018)#
protest_main <- "Protest on Attending a Protest,"#
protest_ylab <- "OLS Coefficient On Norm To Attend Protest"#
#
protestF <- #
c(0.0587314,#
0.073317,#
0.0531946,#
0.0648408)#
#
protestF_se <- #
c(0.013,#
0.013,#
0.008,#
0.013)#
#
protestM <- #
c(0.1069584,#
0.0574463,#
0.0333203,#
0.0430373)#
#
protestM_se <- #
c(0.021,#
0.016,#
0.015,#
0.013)#
social_main <- "Use Social Media for Politics on Posting Politics on Social Media,"#
social_ylab <- "OLS Coefficient On Norm To Use Social Media For Politics"#
#
socialF <- #
c(0.1587346,#
0.1203141,#
0.1219445,#
0.1289472)#
#
socialF_se <- #
c(0.022,#
0.014,#
0.012,#
0.02)#
#
socialM <- #
c(0.1462155,#
0.0897798,#
0.1250902,#
0.1150495)#
#
socialM_se <- #
c(0.029,#
0.02,#
0.017,#
0.02)#
vote_main <- "Vote on Voting in 2016,"#
vote_ylab <- "OLS Coefficient On Norm To Vote"#
#
voteF <- #
c(0.1444461,#
0.1028096,#
0.1239695,#
0.1057274)#
#
voteF_se <- #
c(0.024,#
0.014,#
0.013,#
0.019)#
#
voteM <- #
c(0.1092774,#
0.0920095,#
0.11765,#
0.1502012)#
#
voteM_se <- #
c(0.026,#
0.018,#
0.017,#
0.022)#
votelocal_main <- "Vote on Voting in State and Local Elections,"#
votelocal_ylab <- "OLS Coefficient On Norm To Vote"#
#
votelocalF <- #
c(0.3150406,#
0.131653,#
0.1585753,#
0.2737248)#
#
votelocalF_se <- #
c(0.067,#
0.043,#
0.034,#
0.047)#
#
votelocalM <- #
c(0.2192945,#
0.1622558,#
0.2397637,#
0.2111982)#
#
votelocalM_se <- #
c(0.081,#
0.057,#
0.041,#
0.073)#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==1#
 cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- formula(. ~ age + age65 + faminc + educ + homeowner + unemployed + pctnonUS + ptystn + orgactive + interest + linkfate + recruitact_ldr)#
summary(m <- lm(update(base.form, contactissue ~ female + normcontactNM + femnormContact +.), weight= weight, data=cmps1))
title <- c(contact_main, commwk_main, donate_main, protest_main, social_main, vote_main, votelocal_main)#
ylabel <- c(contact_ylab, commwk_ylab, donate_ylab, protest_ylab, social_ylab, vote_ylab, votelocal_ylab)#
beta1 <- c(contactF, commwkF, donateF, protestF, socialF, voteF, votelocalF)#
beta2 <- c(contactM, commwkM, donateM, protestM, socialM, voteM, votelocalM)#
se1 <- c(contactF_se, commwkF_se, donateF_se, protestF_se, socialF_se, voteF_se, votelocalF_se)#
se2 <- c(contactM_se, commwkM_se, donateM_se, protestM_se, socialM_se, voteM_se, votelocalM_se)#
contact_main <- "Contact on Contacting on an Issue,"#
contact_ylab <- "OLS Coefficient On Norm To Contact On Issues"#
#
contactF <- #
c(0.0860655,#
0.0697297,#
0.0478951,#
0.0454305)#
#
contactF_se <- #
c(0.019,#
0.013,#
0.01,#
0.017)#
#
contactM <- #
c(0.1488321,#
0.0566743,#
0.0497024,#
0.0659856)#
#
contactM_se <- #
c(0.029,#
0.016,#
0.014,#
0.022)#
commwk_main <- "Work on Community Problem on Working to Solve a Community Problem,"#
commwk_ylab <- "OLS Coefficient On Norm To Work With Others To Solve Community Problem"#
#
commwkF <- #
c(0.0755397,#
0.0645092,#
0.0431188,#
0.0594256)#
#
commwkF_se <- #
c(0.017,#
0.013,#
0.009,#
0.018)#
#
commwkM <- #
c(0.1290913,#
0.078696,#
0.0828597,#
0.0851571)#
#
commwkM_se <- #
c(0.025,#
0.016,#
0.016,#
0.019)#
donate_main <- "Donate on Donating to a Campaign,"#
donate_ylab <- "OLS Coefficient On Norm To Donate To A Campaign Or Cause"#
#
donateF <- #
c(0.0937791,#
0.0607834,#
0.0614953,#
0.0701727)#
#
donateF_se <- #
c(0.019,#
0.012,#
0.009,#
0.016)#
#
donateM <- #
c(0.1583963,#
0.0870401,#
0.0892198,#
0.0830664)#
#
donateM_se <- #
c(0.024,#
0.018,#
0.017,#
0.018)#
protest_main <- "Protest on Attending a Protest,"#
protest_ylab <- "OLS Coefficient On Norm To Attend Protest"#
#
protestF <- #
c(0.0587314,#
0.073317,#
0.0531946,#
0.0648408)#
#
protestF_se <- #
c(0.013,#
0.013,#
0.008,#
0.013)#
#
protestM <- #
c(0.1069584,#
0.0574463,#
0.0333203,#
0.0430373)#
#
protestM_se <- #
c(0.021,#
0.016,#
0.015,#
0.013)#
social_main <- "Use Social Media for Politics on Posting Politics on Social Media,"#
social_ylab <- "OLS Coefficient On Norm To Use Social Media For Politics"#
#
socialF <- #
c(0.1587346,#
0.1203141,#
0.1219445,#
0.1289472)#
#
socialF_se <- #
c(0.022,#
0.014,#
0.012,#
0.02)#
#
socialM <- #
c(0.1462155,#
0.0897798,#
0.1250902,#
0.1150495)#
#
socialM_se <- #
c(0.029,#
0.02,#
0.017,#
0.02)#
vote_main <- "Vote on Voting in 2016,"#
vote_ylab <- "OLS Coefficient On Norm To Vote"#
#
voteF <- #
c(0.1444461,#
0.1028096,#
0.1239695,#
0.1057274)#
#
voteF_se <- #
c(0.024,#
0.014,#
0.013,#
0.019)#
#
voteM <- #
c(0.1092774,#
0.0920095,#
0.11765,#
0.1502012)#
#
voteM_se <- #
c(0.026,#
0.018,#
0.017,#
0.022)#
votelocal_main <- "Vote on Voting in State and Local Elections,"#
votelocal_ylab <- "OLS Coefficient On Norm To Vote"#
#
votelocalF <- #
c(0.3150406,#
0.131653,#
0.1585753,#
0.2737248)#
#
votelocalF_se <- #
c(0.067,#
0.043,#
0.034,#
0.047)#
#
votelocalM <- #
c(0.2192945,#
0.1622558,#
0.2397637,#
0.2111982)#
#
votelocalM_se <- #
c(0.081,#
0.057,#
0.041,#
0.073)#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==1#
 cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- formula(. ~ age + age65 + faminc + educ + homeowner + unemployed + pctnonUS + ptystn + orgactive + interest + linkfate + recruitact_ldr)#
summary(m <- lm(update(base.form, contactissue ~ female + normcontactNM + femnormContact +.), weight= weight, data=cmps1))
title <- c(contact_main, commwk_main, donate_main, protest_main, social_main, vote_main, votelocal_main)#
ylabel <- c(contact_ylab, commwk_ylab, donate_ylab, protest_ylab, social_ylab, vote_ylab, votelocal_ylab)#
beta1 <- c(contactF, commwkF, donateF, protestF, socialF, voteF, votelocalF)#
beta2 <- c(contactM, commwkM, donateM, protestM, socialM, voteM, votelocalM)#
se1 <- c(contactF_se, commwkF_se, donateF_se, protestF_se, socialF_se, voteF_se, votelocalF_se)#
se2 <- c(contactM_se, commwkM_se, donateM_se, protestM_se, socialM_se, voteM_se, votelocalM_se)#
contact_main <- "Contact on Contacting on an Issue,"#
contact_ylab <- "OLS Coefficient On Norm To Contact On Issues"#
#
contactF <- #
c(0.0860655,#
0.0697297,#
0.0478951,#
0.0454305)#
#
contactF_se <- #
c(0.019,#
0.013,#
0.01,#
0.017)#
#
contactM <- #
c(0.1488321,#
0.0566743,#
0.0497024,#
0.0659856)#
#
contactM_se <- #
c(0.029,#
0.016,#
0.014,#
0.022)#
commwk_main <- "Work on Community Problem on Working to Solve a Community Problem,"#
commwk_ylab <- "OLS Coefficient On Norm To Work With Others To Solve Community Problem"#
#
commwkF <- #
c(0.0755397,#
0.0645092,#
0.0431188,#
0.0594256)#
#
commwkF_se <- #
c(0.017,#
0.013,#
0.009,#
0.018)#
#
commwkM <- #
c(0.1290913,#
0.078696,#
0.0828597,#
0.0851571)#
#
commwkM_se <- #
c(0.025,#
0.016,#
0.016,#
0.019)#
donate_main <- "Donate on Donating to a Campaign,"#
donate_ylab <- "OLS Coefficient On Norm To Donate To A Campaign Or Cause"#
#
donateF <- #
c(0.0937791,#
0.0607834,#
0.0614953,#
0.0701727)#
#
donateF_se <- #
c(0.019,#
0.012,#
0.009,#
0.016)#
#
donateM <- #
c(0.1583963,#
0.0870401,#
0.0892198,#
0.0830664)#
#
donateM_se <- #
c(0.024,#
0.018,#
0.017,#
0.018)#
protest_main <- "Protest on Attending a Protest,"#
protest_ylab <- "OLS Coefficient On Norm To Attend Protest"#
#
protestF <- #
c(0.0587314,#
0.073317,#
0.0531946,#
0.0648408)#
#
protestF_se <- #
c(0.013,#
0.013,#
0.008,#
0.013)#
#
protestM <- #
c(0.1069584,#
0.0574463,#
0.0333203,#
0.0430373)#
#
protestM_se <- #
c(0.021,#
0.016,#
0.015,#
0.013)#
social_main <- "Use Social Media for Politics on Posting Politics on Social Media,"#
social_ylab <- "OLS Coefficient On Norm To Use Social Media For Politics"#
#
socialF <- #
c(0.1587346,#
0.1203141,#
0.1219445,#
0.1289472)#
#
socialF_se <- #
c(0.022,#
0.014,#
0.012,#
0.02)#
#
socialM <- #
c(0.1462155,#
0.0897798,#
0.1250902,#
0.1150495)#
#
socialM_se <- #
c(0.029,#
0.02,#
0.017,#
0.02)#
vote_main <- "Vote on Voting in 2016,"#
vote_ylab <- "OLS Coefficient On Norm To Vote"#
#
voteF <- #
c(0.1444461,#
0.1028096,#
0.1239695,#
0.1057274)#
#
voteF_se <- #
c(0.024,#
0.014,#
0.013,#
0.019)#
#
voteM <- #
c(0.1092774,#
0.0920095,#
0.11765,#
0.1502012)#
#
voteM_se <- #
c(0.026,#
0.018,#
0.017,#
0.022)#
votelocal_main <- "Vote on Voting in State and Local Elections,"#
votelocal_ylab <- "OLS Coefficient On Norm To Vote"#
#
votelocalF <- #
c(0.3150406,#
0.131653,#
0.1585753,#
0.2737248)#
#
votelocalF_se <- #
c(0.067,#
0.043,#
0.034,#
0.047)#
#
votelocalM <- #
c(0.2192945,#
0.1622558,#
0.2397637,#
0.2111982)#
#
votelocalM_se <- #
c(0.081,#
0.057,#
0.041,#
0.073)#
# cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
# citizen <- cmps$citizen==1#
# ethnic_quota <- cmps$ethnic_quota==1#
#  cmps1 <- cmps[citizen & ethnic_quota,]#
#  base.form <- formula(. ~ age + age65 + faminc + educ + homeowner + unemployed + pctnonUS + ptystn + orgactive + interest + linkfate + recruitact_ldr)#
# summary(m <- lm(update(base.form, contactissue ~ female + normcontactNM + femnormContact +.), weight= weight, data=cmps1))
j <- 1
paste("Marginal Effect of Norm to", title[j],"\nOLS Coefficient & 95% Confidence Intervals")
ylab <- ylabel[j]
ylab
main <- paste("Marginal Effect of Norm to", title[j],"\nOLS Coefficient & 95% Confidence Intervals")#
ylab <- ylabel[j]#
xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(beta1[j], beta2[j], beta1[j], beta2[j], "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
beta1[j]
beta2[j]
CI(data1[j], se1[j], level=0.95)
CI(beta1[j], se1[j], level=0.95)
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.75, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.75, data1[1,4], 3.81, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*2, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
main <- paste("Marginal Effect of Norm to", title[j],"\nOLS Coefficient & 95% Confidence Intervals")#
ylab <- ylabel[j]#
xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(beta1[j], beta2[j], se1[j], se2[j], "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
se1[j]
beta1
votelocalF
beta1
beta1 <- c("contactF", "commwkF", "donateF", "protestF", "socialF", "voteF", "votelocalF")
beta1
get(beta1[j])
title <- c("contact_main", "commwk_main", "donate_main", "protest_main", "social_main", "vote_main", "votelocal_main")#
ylabel <- c("contact_ylab", "commwk_ylab", "donate_ylab", "protest_ylab", "social_ylab", "vote_ylab", "votelocal_ylab")#
beta1 <- c("contactF", "commwkF", "donateF", "protestF", "socialF", "voteF", "votelocalF")#
beta2 <- c("contactM", "commwkM", "donateM", "protestM", "socialM", "voteM", "votelocalM")#
se1 <- c("contactF_se", "commwkF_se", "donateF_se", "protestF_se", "socialF_se", "voteF_se", "votelocalF_se")#
se2 <- c("contactM_se", "commwkM_se", "donateM_se", "protestM_se", "socialM_se", "voteM_se", "votelocalM_se")#
contact_main <- "Contact on Contacting on an Issue,"#
contact_ylab <- "OLS Coefficient On Norm To Contact On Issues"
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*3, length = 0.2, col='black')#
text(4, legend.placement*3, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.75, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.75, data1[1,4], 3.81, legend.placement*2, length = 0.2, col='black')#
text(3.81, legend.placement*2, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
ylab <- get(ylabel[j])#
xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
#
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)#
plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
# dev.off()
par(mfrow=c(3,4))
main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")
ylab <- get(ylabel[j])
xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")
# pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 5)
plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)
par(mfrow=c(4,2))
plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 10)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*2, length = 0.2, col='black')#
text(4, legend.placement*2, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.75, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.75, data1[1,4], 3.81, legend.placement*1.5, length = 0.2, col='black')#
text(3.81, legend.placement*1.5, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*2, length = 0.2, col='black')#
text(4, legend.placement*2, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, legend.placement*1.5, length = 0.2, col='black')#
text(3.75, legend.placement*1.5, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                # ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
                ylim <- c(-0.05, 0.5)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*2, length = 0.2, col='black')#
text(4, legend.placement*2, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, legend.placement*1.5, length = 0.2, col='black')#
text(3.75, legend.placement*1.5, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                # ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
                ylim <- c(-0.05, 0.3)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*2, length = 0.2, col='black')#
text(4, legend.placement*2, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, legend.placement*1.5, length = 0.2, col='black')#
text(3.75, legend.placement*1.5, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                # ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
                ylim <- c(-0.05, 0.4)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, legend.placement*2, length = 0.2, col='black')#
text(4, legend.placement*2, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, legend.placement*1.5, length = 0.2, col='black')#
text(3.75, legend.placement*1.5, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                # ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
                ylim <- c(-0.05, 0.4)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, 0.4, length = 0.2, col='black')#
text(4,0.4, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                # ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
                ylim <- c(-0.05, 0.4)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
text(4, 0.30, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                # ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
                ylim <- c(-0.05, 0.4)#
        par(mar=c(3,4,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
title <- c("contact_main", "commwk_main", "donate_main", "protest_main", "social_main", "vote_main", "votelocal_main")#
ylabel <- c("contact_ylab", "commwk_ylab", "donate_ylab", "protest_ylab", "social_ylab", "vote_ylab", "votelocal_ylab")#
beta1 <- c("contactF", "commwkF", "donateF", "protestF", "socialF", "voteF", "votelocalF")#
beta2 <- c("contactM", "commwkM", "donateM", "protestM", "socialM", "voteM", "votelocalM")#
se1 <- c("contactF_se", "commwkF_se", "donateF_se", "protestF_se", "socialF_se", "voteF_se", "votelocalF_se")#
se2 <- c("contactM_se", "commwkM_se", "donateM_se", "protestM_se", "socialM_se", "voteM_se", "votelocalM_se")#
contact_main <- "Contact on Contacting on an Issue,"#
contact_ylab <- "OLS Coefficient On Norm \nTo Contact On Issues"#
#
contactF <- #
c(0.0860655,#
0.0697297,#
0.0478951,#
0.0454305)#
#
contactF_se <- #
c(0.019,#
0.013,#
0.01,#
0.017)#
#
contactM <- #
c(0.1488321,#
0.0566743,#
0.0497024,#
0.0659856)#
#
contactM_se <- #
c(0.029,#
0.016,#
0.014,#
0.022)#
commwk_main <- "Work on Community Problem on Working to Solve a Community Problem,"#
commwk_ylab <- "OLS Coefficient On Norm To Work With Others \nTo Solve Community Problem"#
#
commwkF <- #
c(0.0755397,#
0.0645092,#
0.0431188,#
0.0594256)#
#
commwkF_se <- #
c(0.017,#
0.013,#
0.009,#
0.018)#
#
commwkM <- #
c(0.1290913,#
0.078696,#
0.0828597,#
0.0851571)#
#
commwkM_se <- #
c(0.025,#
0.016,#
0.016,#
0.019)#
donate_main <- "Donate on Donating to a Campaign,"#
donate_ylab <- "OLS Coefficient On Norm To Donate \nTo A Campaign Or Cause"#
#
donateF <- #
c(0.0937791,#
0.0607834,#
0.0614953,#
0.0701727)#
#
donateF_se <- #
c(0.019,#
0.012,#
0.009,#
0.016)#
#
donateM <- #
c(0.1583963,#
0.0870401,#
0.0892198,#
0.0830664)#
#
donateM_se <- #
c(0.024,#
0.018,#
0.017,#
0.018)#
protest_main <- "Protest on Attending a Protest,"#
protest_ylab <- "OLS Coefficient On Norm \nTo Attend Protest"#
#
protestF <- #
c(0.0587314,#
0.073317,#
0.0531946,#
0.0648408)#
#
protestF_se <- #
c(0.013,#
0.013,#
0.008,#
0.013)#
#
protestM <- #
c(0.1069584,#
0.0574463,#
0.0333203,#
0.0430373)#
#
protestM_se <- #
c(0.021,#
0.016,#
0.015,#
0.013)#
social_main <- "Use Social Media for Politics on Posting Politics on Social Media,"#
social_ylab <- "OLS Coefficient On Norm \nTo Use Social Media For Politics"#
#
socialF <- #
c(0.1587346,#
0.1203141,#
0.1219445,#
0.1289472)#
#
socialF_se <- #
c(0.022,#
0.014,#
0.012,#
0.02)#
#
socialM <- #
c(0.1462155,#
0.0897798,#
0.1250902,#
0.1150495)#
#
socialM_se <- #
c(0.029,#
0.02,#
0.017,#
0.02)#
vote_main <- "Vote on Voting in 2016,"#
vote_ylab <- "OLS Coefficient On Norm \nTo Vote"#
#
voteF <- #
c(0.1444461,#
0.1028096,#
0.1239695,#
0.1057274)#
#
voteF_se <- #
c(0.024,#
0.014,#
0.013,#
0.019)#
#
voteM <- #
c(0.1092774,#
0.0920095,#
0.11765,#
0.1502012)#
#
voteM_se <- #
c(0.026,#
0.018,#
0.017,#
0.022)#
votelocal_main <- "Vote on Voting in State and Local Elections,"#
votelocal_ylab <- "OLS Coefficient On Norm \nTo Vote"#
#
votelocalF <- #
c(0.3150406,#
0.131653,#
0.1585753,#
0.2737248)#
#
votelocalF_se <- #
c(0.067,#
0.043,#
0.034,#
0.047)#
#
votelocalM <- #
c(0.2192945,#
0.1622558,#
0.2397637,#
0.2111982)#
#
votelocalM_se <- #
c(0.081,#
0.057,#
0.041,#
0.073)#
# cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
# citizen <- cmps$citizen==1#
# ethnic_quota <- cmps$ethnic_quota==1#
#  cmps1 <- cmps[citizen & ethnic_quota,]#
#  base.form <- formula(. ~ age + age65 + faminc + educ + homeowner + unemployed + pctnonUS + ptystn + orgactive + interest + linkfate + recruitact_ldr)#
# summary(m <- lm(update(base.form, contactissue ~ female + normcontactNM + femnormContact +.), weight= weight, data=cmps1))
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                # ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
                ylim <- c(-0.05, 0.4)#
        par(mar=c(3,5,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                # ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
                ylim <- c(-0.05, 0.4)#
        par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), "F", "M", main=main, xlab=xlab, ylab=ylab)#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
    lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.3))#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
    lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
# text(x=as.Date(c("01/01/2010"), "%m/%d/%Y"), y=50, labels="Sum of the Very Favorable and Mostly Favorable categories", cex=0.65)#
                # legend("topright", legend="95% Confidence", text.col="#000000", bty="n", cex=1, text.font=2, adj = c(-0.02,0.0))#
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.3))#
    }#
dev.off()
plot.coef.bars <- #
    function (betasM, betasF, seM, seF, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betasF, seF, level=0.95)#
            data2 <- CI(betasM, seM, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
#   lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
# arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
# text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
        }#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.3))#
    }#
dev.off()
}#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
#
    plot.coef.bars(get(beta1[j]), get(beta2[j]), get(se1[j]), get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))#
    }#
dev.off()
beta1
plot.coef.bars <- #
    function (betas1, betas2, se1, se2, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betas1, se1, level=0.95)#
            data2 <- CI(betas2, se2, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(1, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
#   lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
# arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
# text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
        }#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 16, height = 15)#
par(mfrow=c(4,2))#
for (j in 1:length(title)) {#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx White", "Latinx", "African American", "Asian American")#
#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))#
    }#
dev.off()
s
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 6, height = 4)
par(mfrow=c(1,1))
plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))
dev.off()
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 7, height = 4)
par(mfrow=c(1,1))
plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))
dev.off()
j <- 3
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 7, height = 4)
par(mfrow=c(1,1))
plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))
dev.off()
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 4)
par(mfrow=c(1,1))
plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))
dev.off()
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 4)
par(mfrow=c(1,1))
xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian n\American")
plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))
dev.off()
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 4)
par(mfrow=c(1,1))
xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")
plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))
dev.off()
plot.coef.bars <- #
    function (betas1, betas2, se1, se2, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betas1, se1, level=0.95)#
            data2 <- CI(betas2, se2, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(0, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
#   lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
# arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
# text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
        }#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 4)#
par(mfrow=c(1,1))
plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))
dev.off()
par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(0.5, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
#   lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
# arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
# text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
        }#
#
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 4)#
par(mfrow=c(1,1))
plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))
dev.off()
plot.coef.bars <- #
    function (betas1, betas2, se1, se2, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betas1, se1, level=0.95)#
            data2 <- CI(betas2, se2, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(0.5, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            text(xx, data1[2,] - 0.01, labels=cat1)#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
            text(xx2, data2[2,] - 0.01, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
#   lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
# arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
# text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
        }
pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/contact.pdf"), width = 8, height = 4)
par(mfrow=c(1,1))
plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))
dev.off()
names <- c("contact", "commwk", "donate", "protest", "social", "vote", "votelocal")
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/", names[j] ,".pdf"), width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))#
    }#
dev.off()
dev.off()
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/", names[j] ,".pdf"), width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=c(-0.05, 0.25))#
        dev.off()#
    }
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/", names[j] ,".pdf"), width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
plot.coef.bars <- #
    function (betas1, betas2, se1, se2, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betas1, se1, level=0.95)#
            data2 <- CI(betas2, se2, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(0.5, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
                        text(xx, data1[2,] - 0.015, labels=cat1)#
                        text(xx2, data2[2,] - 0.015, labels=cat2)
}
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/", names[j] ,".pdf"), width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
`CI` <- #
    function(x, se, level=0.95) {#
        if (level==0.95) z <- 1.96#
        if (level==0.90) z <- 1.645#
        ci <- rbind(x, x - (z * se), x + (z * se))#
        rownames(ci) <- c("beta", "lower", "upper")#
        return(ci)#
    }#
round.ceiling <- function(x, d) ceiling(x/d)*d#
round.floor <- function(x, d) floor(x/d)*d#
plot.coef.bars <- #
    function (betas1, betas2, se1, se2, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betas1, se1, level=0.95)#
            data2 <- CI(betas2, se2, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,6,3,3))#
            plot(x = xx, y = yy, xlim = c(0.5, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
                        text(xx, data1[2,] - 0.02, labels=cat1)#
                        text(xx2, data2[2,] - 0.02, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
#   lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
# arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
# text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
        }#
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/", names[j] ,".pdf"), width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
`CI` <- #
    function(x, se, level=0.95) {#
        if (level==0.95) z <- 1.96#
        if (level==0.90) z <- 1.645#
        ci <- rbind(x, x - (z * se), x + (z * se))#
        rownames(ci) <- c("beta", "lower", "upper")#
        return(ci)#
    }#
round.ceiling <- function(x, d) ceiling(x/d)*d#
round.floor <- function(x, d) floor(x/d)*d#
plot.coef.bars <- #
    function (betas1, betas2, se1, se2, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betas1, se1, level=0.95)#
            data2 <- CI(betas2, se2, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,5.5,3,3))#
            plot(x = xx, y = yy, xlim = c(0.5, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
                        text(xx, data1[2,] - 0.02, labels=cat1)#
                        text(xx2, data2[2,] - 0.02, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
#   lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
# arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
# text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
        }#
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/", names[j] ,".pdf"), width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
`CI` <- #
    function(x, se, level=0.95) {#
        if (level==0.95) z <- 1.96#
        if (level==0.90) z <- 1.645#
        ci <- rbind(x, x - (z * se), x + (z * se))#
        rownames(ci) <- c("beta", "lower", "upper")#
        return(ci)#
    }#
round.ceiling <- function(x, d) ceiling(x/d)*d#
round.floor <- function(x, d) floor(x/d)*d#
plot.coef.bars <- #
    function (betas1, betas2, se1, se2, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betas1, se1, level=0.95)#
            data2 <- CI(betas2, se2, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,5.5,3,2))#
            plot(x = xx, y = yy, xlim = c(0.5, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
                        text(xx, data1[2,] - 0.02, labels=cat1)#
                        text(xx2, data2[2,] - 0.02, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
#   lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
# arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
# text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
        }#
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/", names[j] ,".pdf"), width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
?png
for (j in 1:length(title)) {#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j] ,".png"), width = 8, height = 4, units=in)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
for (j in 1:length(title)) {#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j] ,".png"), width = 8, height = 4, units="in")#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
for (j in 1:length(title)) {#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j] ,".png"), width = 8, height = 4, units=in)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/pdf/", names[j] ,".pdf"), width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }#
#
for (j in 1:length(title)) {#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j] ,".png"), width = 8, height = 4, units=in)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j] ,".png"), width = 8, height = 4, units=in)
for (j in 1:length(title)) {#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j] ,".png"), units=in, width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
for (j in 1:length(title)) {#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j] ".png"), units="px", width=800,height=(600))#
        par(mfrow=c(1,1))#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j] ".png")
for (j in 1:length(title)) {#
    # png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="px", width=800,height=(600))#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units=in, width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png")
png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units=inches, width = 8, height = 4)
png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="in", width = 8, height = 4)
for (j in 1:length(title)) {#
    # png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="px", width=800,height=(600))#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="in", res=500, width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/pdf/", names[j] ,".pdf"), width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }#
#
for (j in 1:length(title)) {#
    # png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="px", width=800,height=(600))#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="in", res=500, width = 8, height = 4)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
summary(m <- lm(update(base.form, contactissue ~ female + normcontactNM + femnormContact +  .), weight= weight, data=cmps1))
coeftest(m, vcov = vcovHC(m, type="HC1"))
library(sandwich)
install.packages('sandwich')
library(sandwich)
coeftest(m, vcov = vcovHC(m, type="HC1"))
install.packages("lmtest")
library(lmtest)
coeftest(m, vcov = vcovHC(m, type="HC1"))
ethnic <- c(1,2,3,4)
length(names)
c("normcontactNM", "norm_commworkNM", "normprotestNM", "normvoteNM", "normvoteNM", "normsummTrad", "normdonateNM")
c("femnormContact", "femnormCommWk", "femnormProt", "femnormVote", "femnormVote", "femnormTrad", "femnormDonate")
normNM <- c("normcontactNM", "norm_commworkNM", "normprotestNM", "normvoteNM", "normvoteNM", "normsummTrad", "normdonateNM")
femnorm <- c("femnormContact", "femnormCommWk", "femnormProt", "femnormVote", "femnormVote", "femnormTrad", "femnormDonate")
dv <- c("socialmedia", "contactissue", "comm_work", "protest", "vote", "votelocal")#
#
normNM <- c("normcontactNM", "norm_commworkNM", "normprotestNM", "normvoteNM", "normvoteNM", "normsummTrad", "normdonateNM")#
femnorm <- c("femnormContact", "femnormCommWk", "femnormProt", "femnormVote", "femnormVote", "femnormTrad", "femnormDonate")#
#
out <- list()#
for(i in length(names)) {#
#
ethnic <- c(1,2,3,4)#
#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==ethnic[i]#
cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- #
    formula(. ~ #
        age + #
        age65 + #
        faminc + #
        educ + #
        homeowner + #
        unemployed + #
        pctnonUS + #
        ptystn + #
        orgactive + #
        interest + #
        linkfate + #
        recruitact_ldr)#
#
summary(m <- lm(update(base.form, dv[i] ~ female + normNM[i] + femnorm[i] +  .), weight= weight, data=cmps1))#
out[[i]] <- coeftest(m, vcov = vcovHC(m, type="HC1"))#
#
}
i
out
dv <- c("contactissue", "comm_work", "protest", "socialmedia", "vote", "votelocal", "socialmedia", "polpartTrad", "donate")
normNM <- c("normcontactNM", "norm_commworkNM", "normprotestNM", "normsocialmediaNM", "normvoteNM", "normvoteNM", "normsummTrad", "normdonateNM")
femnorm <- c("femnormContact", "femnormCommWk", "femnormProt", "femnormSocial", "femnormVote", "femnormVote", "femnormTrad", "femnormDonate")
normNM
dv
femnorm
dv <- c("contactissue", "comm_work", "protest", "socialmedia", "vote", "votelocal", "polpartTrad", "donate")#
normNM <- c("normcontactNM", "norm_commworkNM", "normprotestNM", "normsocialmediaNM", "normvoteNM", "normvoteNM", "normsummTrad", "normdonateNM")#
femnorm <- c("femnormContact", "femnormCommWk", "femnormProt", "femnormSocial", "femnormVote", "femnormVote", "femnormTrad", "femnormDonate")#
#
out <- list()#
for(i in length(names)) {#
#
ethnic <- c(1,2,3,4)#
#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==ethnic[i]#
cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- #
    formula(. ~ #
        age + #
        age65 + #
        faminc + #
        educ + #
        homeowner + #
        unemployed + #
        pctnonUS + #
        ptystn + #
        orgactive + #
        interest + #
        linkfate + #
        recruitact_ldr)#
#
summary(m <- lm(update(base.form, dv[i] ~ female + normNM[i] + femnorm[i] +  .), weight= weight, data=cmps1))#
out[[i]] <- coeftest(m, vcov = vcovHC(m, type="HC1"))#
#
}
femnorm[i]
normNM[i]
dv <- c("contactissue", "comm_work", "protest", "socialmedia", "vote", "votelocal", "donate")#
normNM <- c("normcontactNM", "norm_commworkNM", "normprotestNM", "normsocialmediaNM", "normvoteNM", "normvoteNM", "normdonateNM")#
femnorm <- c("femnormContact", "femnormCommWk", "femnormProt", "femnormSocial", "femnormVote", "femnormVote", "femnormDonate")#
#
out <- list()#
for(i in length(names)) {#
#
ethnic <- c(1,2,3,4)#
#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==ethnic[i]#
cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- #
    formula(. ~ #
        age + #
        age65 + #
        faminc + #
        educ + #
        homeowner + #
        unemployed + #
        pctnonUS + #
        ptystn + #
        orgactive + #
        interest + #
        linkfate + #
        recruitact_ldr)#
#
summary(m <- lm(update(base.form, dv[i] ~ female + normNM[i] + femnorm[i] +  .), weight= weight, data=cmps1))#
out[[i]] <- coeftest(m, vcov = vcovHC(m, type="HC1"))#
#
}
normNM[i]
dv <- c("contactissue", "comm_work", "protest", "socialmedia", "donate")#
normNM <- c("normcontactNM", "norm_commworkNM", "normprotestNM", "normsocialmediaNM", "normdonateNM")#
femnorm <- c("femnormContact", "femnormCommWk", "femnormProt", "femnormSocial", "femnormDonate")#
#
out <- list()#
for(i in length(names)) {#
#
ethnic <- c(1,2,3,4)#
#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==ethnic[i]#
cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- #
    formula(. ~ #
        age + #
        age65 + #
        faminc + #
        educ + #
        homeowner + #
        unemployed + #
        pctnonUS + #
        ptystn + #
        orgactive + #
        interest + #
        linkfate + #
        recruitact_ldr)#
#
summary(m <- lm(update(base.form, dv[i] ~ female + normNM[i] + femnorm[i] +  .), weight= weight, data=cmps1))#
out[[i]] <- coeftest(m, vcov = vcovHC(m, type="HC1"))#
#
}
dv[i]
i
dv
dv <- c("contactissue", "comm_work", "protest", "socialmedia", "vote", "votelocal", "donate")#
normNM <- c("normcontactNM", "norm_commworkNM", "normprotestNM", "normsocialmediaNM", "normvoteNM", "normvoteNM", "normdonateNM")#
femnorm <- c("femnormContact", "femnormCommWk", "femnormProt", "femnormSocial", "femnormVote", "femnormVote", "femnormDonate")#
#
out <- list()#
for(i in length(dv)) {#
#
ethnic <- c(1,2,3,4)#
#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==ethnic[i]#
cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- #
    formula(. ~ #
        age + #
        age65 + #
        faminc + #
        educ + #
        homeowner + #
        unemployed + #
        pctnonUS + #
        ptystn + #
        orgactive + #
        interest + #
        linkfate + #
        recruitact_ldr)#
#
summary(m <- lm(update(base.form, dv[i] ~ female + normNM[i] + femnorm[i] +  .), weight= weight, data=cmps1))#
out[[i]] <- coeftest(m, vcov = vcovHC(m, type="HC1"))#
#
}
dv[i]
normNM[i]
femnorm[i]
summary(m <- lm(update(base.form, dv[i] ~ female + normNM[i] + femnorm[i] +  .), weight= weight, data=cmps1))
cmps1
dv <- c("contactissue", "comm_work", "protest", "socialmedia", "vote", "votelocal", "donate")#
normNM <- c("normcontactNM", "norm_commworkNM", "normprotestNM", "normsocialmediaNM", "normvoteNM", "normvoteNM", "normdonateNM")#
femnorm <- c("femnormContact", "femnormCommWk", "femnormProt", "femnormSocial", "femnormVote", "femnormVote", "femnormDonate")#
#
out <- list()#
for(j in 1:length(dv)) {#
#
ethnic <- c(1,2,3,4)#
#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
for(i in 1:length(ethnic)) {#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==ethnic[i]#
cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- #
    formula(. ~ #
        age + #
        age65 + #
        faminc + #
        educ + #
        homeowner + #
        unemployed + #
        pctnonUS + #
        ptystn + #
        orgactive + #
        interest + #
        linkfate + #
        recruitact_ldr)#
#
summary(m <- lm(update(base.form, dv[i] ~ female + normNM[i] + femnorm[i] +  .), weight= weight, data=cmps1))#
out[[i]] <- coeftest(m, vcov = vcovHC(m, type="HC1"))#
    }#
}
dv[i]
normNM[i]
femnorm[i]
cmps1
summary(m <- lm(update(base.form, dv[i] ~ female + normNM[i] + femnorm[i] +  .), weight= weight, data=cmps1))
title <- c("contact_main", "commwk_main", "donate_main", "protest_main", "social_main", "vote_main", "votelocal_main")#
ylabel <- c("contact_ylab", "commwk_ylab", "donate_ylab", "protest_ylab", "social_ylab", "vote_ylab", "votelocal_ylab")#
beta1 <- c("contactF", "commwkF", "donateF", "protestF", "socialF", "voteF", "votelocalF")#
beta2 <- c("contactM", "commwkM", "donateM", "protestM", "socialM", "voteM", "votelocalM")#
se1 <- c("contactF_se", "commwkF_se", "donateF_se", "protestF_se", "socialF_se", "voteF_se", "votelocalF_se")#
se2 <- c("contactM_se", "commwkM_se", "donateM_se", "protestM_se", "socialM_se", "voteM_se", "votelocalM_se")#
#
names <- c("contact", "commwk", "donate", "protest", "social", "vote", "votelocal")#
#
contact_main <- "Contact on Contacting on an Issue,"#
contact_ylab <- "OLS Coefficient On Norm \nTo Contact On Issues"#
#
contactF <- #
c(0.0860655,#
0.0697297,#
0.0478951,#
0.0454305)#
#
contactF_se <- #
c(0.019,#
0.013,#
0.01,#
0.017)#
#
contactM <- #
c(0.1488321,#
0.0566743,#
0.0497024,#
0.0659856)#
#
contactM_se <- #
c(0.029,#
0.016,#
0.014,#
0.022)#
commwk_main <- "Work on Community Problem on Working \nto Solve a Community Problem,"#
commwk_ylab <- "OLS Coefficient On Norm To Work With Others \nTo Solve Community Problem"#
#
commwkF <- #
c(0.0755397,#
0.0645092,#
0.0431188,#
0.0594256)#
#
commwkF_se <- #
c(0.017,#
0.013,#
0.009,#
0.018)#
#
commwkM <- #
c(0.1290913,#
0.078696,#
0.0828597,#
0.0851571)#
#
commwkM_se <- #
c(0.025,#
0.016,#
0.016,#
0.019)#
donate_main <- "Donate on Donating to a Campaign,"#
donate_ylab <- "OLS Coefficient On Norm To Donate \nTo A Campaign Or Cause"#
#
donateF <- #
c(0.0937791,#
0.0607834,#
0.0614953,#
0.0701727)#
#
donateF_se <- #
c(0.019,#
0.012,#
0.009,#
0.016)#
#
donateM <- #
c(0.1583963,#
0.0870401,#
0.0892198,#
0.0830664)#
#
donateM_se <- #
c(0.024,#
0.018,#
0.017,#
0.018)#
protest_main <- "Protest on Attending a Protest,"#
protest_ylab <- "OLS Coefficient On Norm \nTo Attend Protest"#
#
protestF <- #
c(0.0587314,#
0.073317,#
0.0531946,#
0.0648408)#
#
protestF_se <- #
c(0.013,#
0.013,#
0.008,#
0.013)#
#
protestM <- #
c(0.1069584,#
0.0574463,#
0.0333203,#
0.0430373)#
#
protestM_se <- #
c(0.021,#
0.016,#
0.015,#
0.013)#
social_main <- "Use Social Media for Politics on Posting Politics on Social Media,"#
social_ylab <- "OLS Coefficient On Norm \nTo Use Social Media For Politics"#
#
socialF <- #
c(0.1587346,#
0.1203141,#
0.1219445,#
0.1289472)#
#
socialF_se <- #
c(0.022,#
0.014,#
0.012,#
0.02)#
#
socialM <- #
c(0.1462155,#
0.0897798,#
0.1250902,#
0.1150495)#
#
socialM_se <- #
c(0.029,#
0.02,#
0.017,#
0.02)#
vote_main <- "Vote on Voting in 2016,"#
vote_ylab <- "OLS Coefficient On Norm \nTo Vote"#
#
voteF <- #
c(0.1444461,#
0.1028096,#
0.1239695,#
0.1057274)#
#
voteF_se <- #
c(0.024,#
0.014,#
0.013,#
0.019)#
#
voteM <- #
c(0.1092774,#
0.0920095,#
0.11765,#
0.1502012)#
#
voteM_se <- #
c(0.026,#
0.018,#
0.017,#
0.022)#
votelocal_main <- "Vote on Voting in State and Local Elections,"#
votelocal_ylab <- "OLS Coefficient On Norm \nTo Vote"#
#
votelocalF <- #
c(0.3150406,#
0.131653,#
0.1585753,#
0.2737248)#
#
votelocalF_se <- #
c(0.067,#
0.043,#
0.034,#
0.047)#
#
votelocalM <- #
c(0.2192945,#
0.1622558,#
0.2397637,#
0.2111982)#
#
votelocalM_se <- #
c(0.081,#
0.057,#
0.041,#
0.073)#
dv <- c("contactissue", "comm_work", "protest", "socialmedia", "vote", "votelocal", "donate")#
normNM <- c("normcontactNM", "norm_commworkNM", "normprotestNM", "normsocialmediaNM", "normvoteNM", "normvoteNM", "normdonateNM")#
femnorm <- c("femnormContact", "femnormCommWk", "femnormProt", "femnormSocial", "femnormVote", "femnormVote", "femnormDonate")#
#
out <- list()#
for(j in 1:length(dv)) {#
#
ethnic <- c(1,2,3,4)#
#
cmps <- read.dta("/Users/cervas/Google Drive/Data/CMPS/CMPSmarch27_19.dta", convert.factors = F)#
for(i in 1:length(ethnic)) {#
citizen <- cmps$citizen==1#
ethnic_quota <- cmps$ethnic_quota==ethnic[i]#
cmps1 <- cmps[citizen & ethnic_quota,]#
 base.form <- #
    formula(. ~ #
        age + #
        age65 + #
        faminc + #
        educ + #
        homeowner + #
        unemployed + #
        pctnonUS + #
        ptystn + #
        orgactive + #
        interest + #
        linkfate + #
        recruitact_ldr)#
#
summary(m <- lm(update(base.form, dv[i] ~ female + normNM[i] + femnorm[i] +  .), weight= weight, data=cmps1))#
out[[i]] <- coeftest(m, vcov = vcovHC(m, type="HC1"))#
    }#
}
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/pdf/", names[j] ,".pdf"), width = 8, height = 7)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }#
#
for (j in 1:length(title)) {#
    # png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="px", width=800,height=(600))#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="in", res=500, width = 8, height = 7)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
`CI` <- #
    function(x, se, level=0.95) {#
        if (level==0.95) z <- 1.96#
        if (level==0.90) z <- 1.645#
        ci <- rbind(x, x - (z * se), x + (z * se))#
        rownames(ci) <- c("beta", "lower", "upper")#
        return(ci)#
    }#
round.ceiling <- function(x, d) ceiling(x/d)*d#
round.floor <- function(x, d) floor(x/d)*d#
plot.coef.bars <- #
    function (betas1, betas2, se1, se2, cat1=NULL, cat2=NULL, main=NULL, labels=NULL, xlab=NULL, ylab=NULL, ylim=NULL) {#
            data1 <- CI(betas1, se1, level=0.95)#
            data2 <- CI(betas2, se2, level=0.95)#
            legend.placement <- ((data2[3,4]-data2[1,4])/2)+data2[1,4]#
            xx <- seq(1,length(xlab),1)#
            xx2 <- xx + 0.15#
            yy <- data1[1,]#
            yy2 <- data2[1,]#
#
                values <- c(data1, data2)#
                if(is.null(ylim)) ylim <- c(min(round.floor(values, 0.05))-0.05, max(round.ceiling(values, 0.05))+0.05)#
        par(mar=c(3,5.5,4,2))#
            plot(x = xx, y = yy, xlim = c(0.5, length(xlab)+0.5), ylim = ylim, main = main, type = "n", yaxt = "n", xaxt = "n", xlab = "", ylab = "", bty = "n")#
            axis(side=2, las=2, labels= seq(ylim[1], ylim[2],0.05), at=seq(ylim[1], ylim[2],0.05), cex.axis=1, font=2)#
            axis(side=1, at = seq(1.12,4.12,1), labels = xlab, cex.axis=1, lwd=0, lwd.ticks=0, font=2)#
            mtext(side=2, line= 3, ylab, cex=1)#
            abline(h=seq(ylim[1], ylim[2], 0.05), lty=2, lwd=0.5, col="gray80")#
            abline(h=0, lwd=1.5, lty=2, col="gray20")#
            arrows(y0=data1[2,], x0=xx, y1=data1[3,], x1=xx, code=3, angle = 90, length=0.1, lwd=1.5)#
            points(xx, data1[1,], cex=1.5, pch=19)#
            # points(xx, yy, cex=3, pch=ifelse(donate_F_low>0, ifelse(donate_F_high<0, 1, 19), 1))#
            # points(xx, yy, pch=ifelse(donate_low<0, ifelse(donate_high>0, 1, 19), 1))#
#
            arrows(y0=data2[2,], x0=xx2, y1=data2[3,], x1=xx2, code=3, angle=90, length=0.1, lty=1, col="gray40", lwd=1.5)#
            points(xx2, data2[1,], cex=1.5, col="gray40", pch=19)#
            # points(xx2, yy2, cex=3, col="gray40", pch=ifelse(donate_M_low>0, ifelse(donate_M_high<0, 1, 19), 1))#
                        text(xx, data1[2,] - 0.02, labels=cat1)#
                        text(xx2, data2[2,] - 0.02, labels=cat2)#
#
#   lines(xy.coords(c(4.18, 4.5), c(legend.placement, legend.placement)))#
# arrows(4.5, legend.placement, 4.25, 0.39, length = 0.2, col='black')#
# text(4, 0.39, labels="95% Confidence Interval", col='black', pos=3, cex=0.85)#
#
#   lines(xy.coords(c(3.7, 3.94), c(data1[1,4], data1[1,4])))#
# arrows(3.7, data1[1,4], 3.75, 0.35, length = 0.2, col='black')#
# text(3.75, 0.35, labels="Point Estimate", col='black', pos=3, cex=0.85)#
        }#
for (j in 1:length(title)) {#
    pdf(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/pdf/", names[j] ,".pdf"), width = 8, height = 7)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }#
#
for (j in 1:length(title)) {#
    # png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="px", width=800,height=(600))#
    png(paste0("/Users/cervas/Google Drive/Projects/Uhlaner/March2019_MPSA/Figures/png/", names[j], ".png"), units="in", res=500, width = 8, height = 7)#
        par(mfrow=c(1,1))#
#
    main <- paste("Marginal Effect of Norm to", get(title[j]),"\nOLS Coefficient & 95% Confidence Intervals")#
    ylab <- get(ylabel[j])#
    xlab <- c("Non-Latinx \nWhite", "Latinx", "African \nAmerican", "Asian \nAmerican")#
    ylim <- c(-0.05, 0.25)#
    if(j==7) ylim <- c(-0.05,0.5)#
    plot.coef.bars(betas1=get(beta1[j]), betas2=get(beta2[j]), se1=get(se1[j]), se2=get(se2[j]), cat1="F", cat2="M", main=main, xlab=xlab, ylab=ylab, ylim=ylim)#
        dev.off()#
    }
###########################################################################################################
# ••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••#
# ••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••#
# ••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••#
# ──╔╦═══╦═╗─╔╦═══╦════╦╗─╔╦═══╦═╗─╔╗#
# ──║║╔═╗║║╚╗║║╔═╗║╔╗╔╗║║─║║╔═╗║║╚╗║║#
# ──║║║─║║╔╗╚╝║║─║╠╝║║╚╣╚═╝║║─║║╔╗╚╝║#
# ╔╗║║║─║║║╚╗║║╚═╝║─║║─║╔═╗║╚═╝║║╚╗║║#
# ║╚╝║╚═╝║║─║║║╔═╗║─║║─║║─║║╔═╗║║─║║║#
# ╚══╩═══╩╝─╚═╩╝─╚╝─╚╝─╚╝─╚╩╝─╚╩╝─╚═╝#
#         ╔═══╦═══╦═══╦╗──╔╦═══╦═══╗#
#         ║╔═╗║╔══╣╔═╗║╚╗╔╝║╔═╗║╔═╗║#
#         ║║─╚╣╚══╣╚═╝╠╗║║╔╣║─║║╚══╗#
#         ║║─╔╣╔══╣╔╗╔╝║╚╝║║╚═╝╠══╗║#
#         ║╚═╝║╚══╣║║╚╗╚╗╔╝║╔═╗║╚═╝║#
#         ╚═══╩═══╩╝╚═╝─╚╝─╚╝─╚╩═══╝#
### Code to Replicate "Tools for Identifying Partisan Gerrymandering"#
# 🅙🅞🅝🅐🅣🅗🅐🅝 🅡. 🅒🅔🅡🅥🅐🅢, University of California Irvine#
# 🅑🅔🅡🅝🅐🅡🅓 🅖🅡🅞🅕🅜🅐🅝, University of California Irvine#
### Note: #
# ••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••#
# ••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••#
# ••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••#
###########################################################################################################
    rm(list=ls(all=TRUE))   # Remove all objects just to be safe.#
    options(scipen=999)     # Turn off Scientific Notation#
    options(stringsAsFactors = FALSE)#
    doInstall <- F#
setwd("/Users/cervas/Google Drive/Papers/Tools for Identifying a Partisan Gerrymander/PA_LWV")  # Main directory#
source("R/license.R")    #
seed <- 66#
set.seed(seed)#
              # Change to FALSE if you don't want packages installed.#
  projection <- "+proj=lcc +lat_1=40.96666666666667 +lat_2=39.93333333333333 +lat_0=39.33333333333334 +lon_0=-77.75 +x_0=600000 +y_0=0 +ellps=GRS80 +datum=NAD83 +to_meter=0.3048006096012192 +no_defs"#
# https://spatialreference.org/ref/epsg/nad83-pennsylvania-south-ftus/#
  projection <- "+init=epsg:4269"#
# •••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••#
  plan_names <- #
    c(#
      "2011 Enacted",#
      "2018 Court Remedial",#
      "Joint Legislative",#
      "Gov. Wolf")#
  plans <- #
    c("enacted2011", #
        "court", #
        "joint", #
        "govwolf")#
# •••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••#
# =================================================================#
# -- FUNCTIONS -- -- FUNCTIONS -- -- FUNCTIONS -- -- FUNCTIONS  -- #
# =================================================================#
    source("R/GERRYfunctions.R")#
    source("/Users/cervas/Google Drive/School/UCI/R Functions/seatsvotes.R")#
# =================================================================#
# -- DATA -- -- DATA -- -- DATA -- -- DATA  -- -- DATA  -- -- DATA #
# =================================================================#
    source("R/PA_Congressional_Data.R")#
    pa.redist.dta <- read.csv("./_data/pa_redist_shp.csv")#
    source("R/DataSetup.R") #
# ================================================================= ##
# -- TOOLS FOR IDENTIFYING PARTISAN  GERRYMANDERING -- ANALYSIS -- -##
# ================================================================= #        #
    source("R/Simulations.R")#
    source("R/GIS.R")#
    source("R/Tables.R")#
    source("R/Plots.R")#
# ================================================================= ##
# -- MEASURES OF GERRYMANDERING -- -- MEASURES OF GERRYMANDERING -- ##
# ================================================================= ##
# Measures of Gerrymandering#
      # WE SHOULD SIMULATE RANDOM DISTRICT AND STATEWIDE SWINGS AND REPORT #
    # AVERAGE SCORES SINCE SOME OF THE MEASURES DO NOT CONTAIN INFORMATION ON RESPONSIVENESS!#
# unc <- function(inp) -1*(inp<0.25)+1*(inp>0.75)#
#
# elecyears <- as.numeric(names(PA_house))#
# same.d <- 1*(elecyears %% 10 != 2)#
# judgeit.bias <- new.list(length(elecyears))#
# names(judgeit.bias) <- elecyears#
# seatsvotes_PA <- new.list(length(elecyears))#
# names(seatsvotes_PA) <- elecyears#
# j.ob <- JudgeIt::judgeit(model.formula=default.unc(VOTE)~unc(VOTE),vote.formula=TURNOUT~1, weight= "turnout", use.last.votes=T, same.d=same.d, data=PA_house)#
# for (j in elecyears) {#
#   judgeit.bias[[as.character(j)]] <- jug.tmp <- JudgeIt::bias.resp(j.ob,year=j)#
# bias_45_55 <- jug.tmp[1]$svsums[2,1]#
# responsiveness_45_55 <- jug.tmp[1]$svsums[3,1]#
# }#
#
# for (j in elecyears) {#
#   seatsvotes_PA[[as.character(j)]] <- seatsvotes(year=j, pct=default.unc(PA_house[[as.character(j)]]$VOTE), weights= PA_house[[as.character(j)]]$TURNOUT, center="average", range=c(0.45, 0.55))#
# }#
#
# judgeit.seats <- new.list(length(elecyears))#
# names(judgeit.seats) <- elecyears#
#
# for (j in elecyears) {#
#   judgeit.seats[[as.character(j)]] <- JudgeIt::seats(j.ob, year = j)#
# }#
# judgeit.plans <- new.list(length(proj.2016))#
#   judgeit.bias.plans <- rep(NA, length(proj.2016))#
# names(judgeit.plans) <- names(proj.2016)#
#   for (p in 1:length(proj.2016))#
#     {#
#   j.ob.plans <- JudgeIt::judgeit(model.formula=R_ave_TP~unc(R_ave_TP),vote.formula=sumTotal~1, weight= "turnout", use.last.votes=F, data=proj.2016[[p]])#
#   judgeit.plans[[as.character(p)]] <- jug.tmp <- JudgeIt::bias.resp(j.ob.plans,year=1)#
#   judgeit.bias.plans[p] <- jug.tmp[1]$svsums[2,1]#
# }
source("R/Tables.R")
source("R/Tables.R")
# AVERAGE VOTE BY DISTRICT#
means_races <- numeric()#
  base.form <- formula(. ~ 1)#
  cong.form <- formula(default.unc(enacted.elections$CONG) ~ + pahouse.2016$INC)#
for (k in colnames(enacted.elections))#
{#
  r.tmp <- composite(pa.redist.dta, "enacted")[,k]#
    reg_races <- summary(lm(update(base.form, as.formula(default.unc(r.tmp) ~ .))))#
    means_races[k] <- coef(reg_races)[1]#
}#
#
  cat(#
    "2016 Average Vote Share by State-level Contest \n"#
    )#
    print(cbind.data.frame(Race = statewide.contests.2016, Mean = percent(means_races)))#
    cat(paste("", collapse = "\n"), "\n")#
# # Regression of Race on Congressional Results#
    reg_cong_pres <- lm(update(cong.form, as.formula(. ~ . + default.unc(enacted.elections$PRES))))#
    reg_cong_ussen <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$USSEN))))#
    reg_cong_atg <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$ATTGEN))))#
    reg_cong_aud <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$AUDITOR))))#
    reg_cong_trea <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$TREASURER))))#
    reg_cong_comp <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$COMPOSITE))))#
    reg_cong_all <- lm(update(cong.form, #
      as.formula(. ~  . +  #
        default.unc(enacted.elections$PRES) + #
        default.unc(enacted.elections$USSEN) +#
        default.unc(enacted.elections$ATTGEN) +#
        default.unc(enacted.elections$AUDITOR) +#
        default.unc(enacted.elections$TREASURER))#
    ))
tab_congress_predict <- stargazer(#
        reg_cong_pres, #
         reg_cong_ussen, #
         reg_cong_atg, #
         reg_cong_aud, #
         reg_cong_trea, #
         reg_cong_comp,#
         reg_cong_all,#
star.cutoffs = c(0.05,0.01, 0.001),#
style = "apsr", #
header = FALSE,#
model.numbers = FALSE,#
initial.zero = TRUE,#
digits = 2,#
column.sep.width = "0pt",#
multicolumn = TRUE,#
omit.stat = c("ll", "F", "ser"),#
dep.var.labels = "Actual Congressional Results (2016)",#
covariate.labels = c("Incumbency Advantage","Presidential", "US Senate", "PA Attorneys General", "PA Auditor", "PA Treasurer", "Composite"),#
label = congress_predict.label,#
title = congress_predict.caption,#
notes = congress_predict.footnote#
    )
tab_congress_predict
tab_congress_predict <- tab_congress_predict[c(-6, -26, -28, -29, -30, -31, -32)]
Table(tab_congress_predict,#
    caption = congress_predict.caption,#
    label = congress_predict.label,#
    footnote = congress_predict.footnote)
Table(#
    tab_plan_summary,#
    caption = plan_summary.caption,#
    label = plan_summary.label,#
    footnote = plan_summary.footnote)
Table(congsum.tmp.tex,#
    caption = congsum.caption,#
    label = congsum.label,#
    footnote = congsum.footnote)
Table(tab_gerry,  #
    caption = gerry.caption,#
    label = gerry.label, #
    footnote = gerry.footnote)
Table(latex(tab_states_compare),  #
    caption = states_compare.caption,#
    label = states_compare.label, #
    footnote = states_compare.footnote)
Table(district_summary,#
    caption = district_summary.caption,#
    label = district_summary.label,#
    footnote = district_summary.footnote#
    )
write.lines("dfkjdfs")
writeLines("dfkjdfs")
write.table(Table(district_summary,#
	caption = district_summary.caption,#
	label = district_summary.label,#
	footnote = district_summary.footnote#
	), "/Tables/tab_district.summary.tex")
write.table(Table(district_summary,#
	caption = district_summary.caption,#
	label = district_summary.label,#
	footnote = district_summary.footnote#
	), "/Tables/tab_district.summary.tex")
write.table(Table(district_summary,#
	caption = district_summary.caption,#
	label = district_summary.label,#
	footnote = district_summary.footnote#
	), "Tables/tab_district.summary.tex")
write.table(writeLines(Table(district_summary,#
	caption = district_summary.caption,#
	label = district_summary.label,#
	footnote = district_summary.footnote#
	), "Tables/tab_district.summary.tex"))
tab_congress_predict <- Table(tab_congress_predict,#
    caption = congress_predict.caption,#
    label = congress_predict.label,#
    footnote = congress_predict.footnote)
tab_congress_predict
Table(tab_congress_predict,#
    caption = congress_predict.caption,#
    label = congress_predict.label,#
    footnote = congress_predict.footnote)
# ••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••#
# AVERAGE VOTE BY DISTRICT#
means_races <- numeric()#
  base.form <- formula(. ~ 1)#
  cong.form <- formula(default.unc(enacted.elections$CONG) ~ + pahouse.2016$INC)#
for (k in colnames(enacted.elections))#
{#
  r.tmp <- composite(pa.redist.dta, "enacted")[,k]#
    reg_races <- summary(lm(update(base.form, as.formula(default.unc(r.tmp) ~ .))))#
    means_races[k] <- coef(reg_races)[1]#
}#
#
  cat(#
    "2016 Average Vote Share by State-level Contest \n"#
    )#
    print(cbind.data.frame(Race = statewide.contests.2016, Mean = percent(means_races)))#
    cat(paste("", collapse = "\n"), "\n")#
# # Regression of Race on Congressional Results#
    reg_cong_pres <- lm(update(cong.form, as.formula(. ~ . + default.unc(enacted.elections$PRES))))#
    reg_cong_ussen <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$USSEN))))#
    reg_cong_atg <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$ATTGEN))))#
    reg_cong_aud <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$AUDITOR))))#
    reg_cong_trea <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$TREASURER))))#
    reg_cong_comp <- lm(update(cong.form, as.formula(. ~ . +  default.unc(enacted.elections$COMPOSITE))))#
    reg_cong_all <- lm(update(cong.form, #
      as.formula(. ~  . +  #
        default.unc(enacted.elections$PRES) + #
        default.unc(enacted.elections$USSEN) +#
        default.unc(enacted.elections$ATTGEN) +#
        default.unc(enacted.elections$AUDITOR) +#
        default.unc(enacted.elections$TREASURER))#
    ))#
#
congress_predict.caption = "Comparing Pennsylvania Congressional Results with State-wide Elections (2016)"#
congress_predict.label = "tab:tab_congress_predict"#
congress_predict.footnote = "$^{*}$p $<$ 0.05; $^{**}$p $<$ .01; $^{***}$p $<$ 0.001 \\\\ Uncontested (or non-competitive) elections replaced with 0.25 \\& 0.75 vote shares. Regressions are unweighted, ie, all districts are assumed to have identical turnout. This is the usual way political scientist measure aggregate congressional vote \\cite{GelmanKing1994_unifiedAJPS}. \\\\"#
#
tab_congress_predict <- stargazer(#
        reg_cong_pres, #
         reg_cong_ussen, #
         reg_cong_atg, #
         reg_cong_aud, #
         reg_cong_trea, #
         reg_cong_comp,#
         reg_cong_all,#
star.cutoffs = c(0.05,0.01, 0.001),#
style = "apsr", #
header = FALSE,#
model.numbers = FALSE,#
initial.zero = TRUE,#
digits = 2,#
column.sep.width = "0pt",#
multicolumn = TRUE,#
omit.stat = c("ll", "F", "ser"),#
dep.var.labels = "Actual Congressional Results (2016)",#
covariate.labels = c("Incumbency Advantage","Presidential", "US Senate", "PA Attorneys General", "PA Auditor", "PA Treasurer", "Composite"),#
label = congress_predict.label,#
title = congress_predict.caption,#
notes = congress_predict.footnote#
    )#
tab_congress_predict <- tab_congress_predict[c(-6, -26, -28, -29, -30, -31, -32)]#
# •••••
